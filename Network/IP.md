## IP 주소란?

IP 주소는 컴퓨터 가상의 주소로 네트워크간 데이터를 주고받을 때 사용된다. 어떤 네트워크의 어떤 호스트에 데이터를 전달할 것인가하는 정보를 담고 있는 주소라고 보면 된다. 목적지 LAN에 도착하고나면 물리 주소인 MAC 주소로 변환하여 특정 호스트에게 데이터를 전달한다. 이렇게 IP 주소를 MAC 주소로 변환해주는 프로토콜이 ARP(Adress Resolution Protocol)이다. ARP는 각각 다른 계층의 주소인 IP 주소를 MAC 주소로 변환시켜주고, RARP(Reverse ARP)는 반대로 MAC 주소를 IP 주소로 변환시켜주는 프로토콜이다.

ARP가 IP 주소를 MAC 주소로 변환하는 과정에서 브로드캐스트 통신과 유니캐스트 통신이 사용된다. 브로드캐스트 통신은 송신 호스트가 다수의 수신 호스트에게 통신하는 방법이고, 유니캐스트는 송신 호스트가 한 대의 수신 호스트에게 1대 1 통신을 하는 방법이다. 즉 ARP가 다수의 호스트에게 가상의 IP 주소와 일치하는 지 물어보고, 일치하는 수신 호스트가 유니캐스트를 통해 알리는 방식이라고 생각하면 쉽다.

<img src="http://pds16.egloos.com/pds/200911/02/07/d0057007_4aeece1e5a1bb.jpg">
출처 : http://egloos.zum.com/wustyle/v/3409644

<br><br>

## IP 주소의 구조 및 클래스

IP 주소는 IPv4와 IPv6로 나누어진다. 기존에 사용하던 것이 IPv4이고, 32비트를 사용해 약 43억개의 IP 주소를 만들 수 있다. 하지만 요즘같이 냉장고에도, 자동차에도 IP 주소가 할당되어야 하는 시대에는 턱없이 부족한 수이다. 그래서 새롭게 나온 게 IPv6로 128비트를 이용해 IP 주소를 나타낸다. 2의 128제곱 가지의 주소를 만들어낼 수 있으니 주소가 모자랄 걱정은 하지 않아도 된다. 이 글에서는 IPv4를 기준으로 IP 주소의 구조와 클래스에 대해 설명한다.

IP 주소를 나타내는 비트들은 네트워크 ID를 나타내는 부분과 호스트 ID를 나타내는 부분으로 또 나눌 수 있다. 네트워크 ID는 어떤 네트워크인지를 특정하는 부분이고 호스트 ID는 그 네트워크 내 어떤 호스트인지를 특정하는 부분이다. IPv4는 총 5개의 클래스로 나눌 수 있는데 대규모 네트워크는 A클래스, 중간 규모의 네트워크는 B클래스, 가정과 같이 소규모의 네트워크에는 C클래스의 주소를 사용한다. 멀티캐스트용의 D클래스와 혹시 모를 사용에 대비해 남겨둔 E클래스까지 총 5가지로 나눌 수 있다.

<img src="https://t1.daumcdn.net/cfile/tistory/99BDB8505BAD9CF70D">
출처 : https://linkhub.tistory.com/118

A클래스는 8비트로 네트워크 ID를 나타내고, 00000000 ~ 01111111 사이의 값을 가질 수 있다. B클래스는 16비트로 네트워크 ID를 나타내고, 10000000.00000000 ~ 10111111.11111111 사이의 값을 가질 수 있다. C클래스는 24비트로 네트워크 ID를 나타내고, 11000000.00000000.00000000 ~ 11011111.11111111.11111111 사이의 값을 가질 수 있다. 십진수로 나타내면 젤 왼쪽의 8비트를 기준으로 각각 0 ~ 127, 128 ~ 191, 192 ~ 223까지의 숫자를 사용할 수 있다.

<br><br>

## 공인 IP 주소와 사설 IP 주소

클래스에 따라 공인 IP 주소의 범위와 사설 IP 주소의 범위가 또 다시 나뉜다. 공인 IP 주소는 인터넷 제공자(ISP)가 제공해주는 IP로 인터넷에 직접 연결되는 라우터나 컴퓨터에 할당된다. 해당 라우터로 구성된 LAN을 이용하는 다른 컴퓨터에는 사설 IP가 할당된다. 사설 IP 주소는 LAN 네트워크 관리자가 직접 설정할 수도 있지만 주로 DHCP(Dynamic Host Configulation Protocol)을 사용해 자동 할당한다. IPv4의 경우 주소가 부족하기 때문에 LAN 내의 여러 컴퓨터들이 하나의 공인 IP를 사용하게 한 것이다. 이때 필요한 것이 NAT(Network Address Translation)이다. 패킷의 IP 주소 정보를 수정해 다른 IP 주소로 매핑하는데 공인 IP를 사설 IP에 매핑할 때 사용한다.

<br><br>

## 네트워크 주소, 브로드캐스트 주소

위에서 호스트 ID는 네트워크 내 개별 컴퓨터를 구별할 때 사용한다고 했다. 하지만 해당 범위 내의 주소 중에 컴퓨터나 라우터가 사용하면 안되는 주소가 딱 2가지 있다. 소규모 네트워크에 해당하는 C클래스를 기준으로 보자면 가장 오른쪽의 8비트가 호스트 ID를 나타내는 부분인데 이 부분이 00000000이거나 11111111인 주소는 IP 주소로 사용하면 안된다. 예를 들자면 192.168.0.0이나 192.168.0.255를 사용할 수 없다는 의미이다.

호스트 ID 부분이 십진수로 0인 경우는 네트워크 주소로 해당 네트워크 전체를 대표하는 주소이다. 호스트 ID 부분이 십진수로 255인 경우는 브로드캐스트 주소로 해당 네트워크 내에 존재하는 모든 호스트에게 데이터를 전달할 때 사용하는 주소이다.

<br><br>

## 서브넷

C클래스의 경우 네트워크 주소와 브로드캐스트 주소를 제외하면 254개밖에 되지 않기 때문에 브로드캐스트 주소를 이용해 전체 호스트에 데이터를 전송해도 큰 문제가 없을 수도 있지만 A클래스의 경우 약 1600만 개 이상의 호스트를 둘 수 있어 네트워크가 매우 혼잡해질 수 있다. 이때 네트워크를 작은 규모의 네트워크로 나눌 수 있는데 나눈 네트워크를 서브넷, 나누는 작업을 서브넷팅이라고 한다.

서브넷의 IP 주소는 네트워크 ID + 서브넷 ID + 호스트 ID의 구조가 된다. 사실상 호스트 ID의 일부를 떼어서 서브넷 ID로 쓰는 것이다. 어디까지가 네트워크 ID이고 어디부터가 호스트 ID인지 나타낸다. 가정용 컴퓨터에서 ipconfig를 쳐보면 서브넷 마스크에 255.255.255.0이 나올 확률이 높은데 이는 C클래스에 서브넷이 없는 경우이다. 즉 네트워크 ID나 서브넷 ID 부분의 비트는 1로, 호스트 ID 부분의 비트는 0으로 나타내어 네트워크 ID와 서브넷 ID만 골라낼 수 있게 해주는게 서브넷 마스크인 것이다. 11111111.11111111.11111111.11110000인 경우는 255.255.255.240이 되는데, C클래스에스 서브넷 ID로 4비트를 더 쓴 경우를 나타낼 수 있다.

<br><br>

## 라우팅

네트워크로 전달하는 데이터 패킷에는 IP헤더가 달려있는데, 여기에는 출발지 IP 주소와 도착지 IP 주소 등 데이터 패킷이 잘 도착할 수 있게 여러 정보가 담겨있다. 이를 기반으로 라우터라는 네트워크 장비는 데이터 패킷이 이동할 경로를 지정하게 된다. 라우터 내의 라우팅 테이블에는 경로와 관련된 정보들이 기록되어 있고 이를 참고해 경로를 찾는 것을 라우팅이라고 한다.

<img src="https://www.itfind.or.kr/WZIN/jugidong/904/Image1196.gif">
<img src="https://www.itfind.or.kr/WZIN/jugidong/904/Image1197.gif">
출처 : https://www.itfind.or.kr/WZIN/jugidong/904/90406.html

<br><br>

## 참고

면접을 위한 CS 전공지식 노트, 주홍철, 길벗, 2022
<br>
모두의 네트워크, 미즈구치 카츠야, 길벗, 2018
<br>
[위키백과](https://ko.wikipedia.org/wiki/%EB%9D%BC%EC%9A%B0%ED%84%B0)
<br>
[NordVPN 블로그](https://nordvpn.com/ko/blog/what-is-subnet-mask/)
